<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>node_modules/truncate-html/readme · Underbase</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;&lt;h1 align=&quot;center&quot;&gt;truncate-html&lt;/h1&gt;&lt;/p&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="node_modules/truncate-html/readme · Underbase"/><meta property="og:type" content="website"/><meta property="og:url" content="https://sundowndev.github.io/underbase/"/><meta property="og:description" content="&lt;p&gt;&lt;h1 align=&quot;center&quot;&gt;truncate-html&lt;/h1&gt;&lt;/p&gt;
"/><meta property="og:image" content="https://sundowndev.github.io/underbase/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://sundowndev.github.io/underbase/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/underbase/img/logo.svg"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://sundowndev.github.io/underbase/blog/atom.xml" title="Underbase Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://sundowndev.github.io/underbase/blog/feed.xml" title="Underbase Blog RSS Feed"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/underbase/js/scrollSpy.js"></script><link rel="stylesheet" href="/underbase/css/main.css"/><script src="/underbase/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/underbase/"><img class="logo" src="/underbase/img/logo.svg" alt="Underbase"/><h2 class="headerTitleWithLogo">Underbase</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/underbase/docs/installation" target="_self">Guides</a></li><li class=""><a href="/underbase/docs/api" target="_self">API</a></li><li class=""><a href="/underbase/blog/" target="_self">Release notes</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">node_modules/truncate-html/readme</h1></header><article><div><span><p><h1 align="center">truncate-html</h1></p>
<p><h5 align="center"> Truncate html string(even contains emoji chars) and keep tags in safe. You can custom ellipsis sign, ignore unwanted elements and truncate html by words. </h5></p>
<div align="center">
  <a href="https://travis-ci.org/evecalm/truncate-html">
    <img src="https://travis-ci.org/evecalm/truncate-html.svg?branch=master" alt="Travis CI">
  </a>
  <a href="#readme">
    <img src="https://badges.frapsoft.com/typescript/code/typescript.svg?v=101" alt="code with typescript" height="20">
  </a>
  <a href="#readme">
    <img src="https://badge.fury.io/js/truncate-html.svg" alt="npm version" height="18">
  </a>
  <a href="https://www.npmjs.com/package/truncate-html">
    <img src="https://img.shields.io/npm/dm/truncate-html.svg" alt="npm version" height="18">
  </a>
</div>
<p><br></p>
<p><strong>Notice</strong> This is a node module depends on <a href="https://github.com/cheeriojs/cheerio">cheerio</a> <em>can only run on nodejs</em>. If you need a browser version, you may consider <a href="https://github.com/pathable/truncate">truncate</a> or <a href="https://github.com/huang47/nodejs-html-truncate">nodejs-html-truncate</a>.</p>
<pre><code class="hljs css language-javascript"><span class="hljs-keyword">const</span> truncate = <span class="hljs-built_in">require</span>(<span class="hljs-string">'truncate-html'</span>)
truncate(<span class="hljs-string">'&lt;p&gt;&lt;img src="xxx.jpg"&gt;Hello from earth!&lt;/p&gt;'</span>, <span class="hljs-number">2</span>, { <span class="hljs-attr">byWords</span>: <span class="hljs-literal">true</span> })
<span class="hljs-comment">// =&gt; &lt;p&gt;&lt;img src="xxx.jpg"&gt;Hello from ...&lt;/p&gt;</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="installation"></a><a href="#installation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h2>
<p><code>npm install truncate-html</code> <br>
or <br>
<code>yarn add truncate-html</code></p>
<h2><a class="anchor" aria-hidden="true" id="try-it-online"></a><a href="#try-it-online" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Try it online</h2>
<p>Click <strong><a href="https://npm.runkit.com/truncate-html">https://npm.runkit.com/truncate-html</a></strong> to try.</p>
<h2><a class="anchor" aria-hidden="true" id="api"></a><a href="#api" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>API</h2>
<pre><code class="hljs css language-javascript"><span class="hljs-comment">/**
 * truncate html
 * @method truncate(html, [length], [options])
 * @param  {String|CheerioStatic}         html    html string to truncate, or  existing cheerio instance(aka cheerio $)
 * @param  {Object|number}  length how many letters(words if `byWords` is true) you want reserve
 * @param  {Object|null}    options
 * @param  {Boolean}        [options.stripTags] remove all tags, default false
 * @param  {String}         [options.ellipsis] ellipsis sign, default '...'
 * @param  {Boolean}        [options.decodeEntities] decode html entities(e.g. convert `&amp;amp;` to `&amp;`) before
 *                                                   counting length, default false
 * @param  {String|Array}   [options.excludes] elements' selector you want ignore
 * @param  {Number}         [options.length] how many letters(words if `byWords` is true)
 *                                           you want reserve
 * @param  {Boolean}        [options.byWords] if true, length means how many words to reserve
 * @param  {Boolean|Number} [options.reserveLastWord] how to deal with when truncate in the middle of a word
 *                                1. by default, just cut at that position.
 *                                2. set it to true, with max exceed 10 letters can exceed to reserver the last word
 *                                3. set it to a positive number decide how many letters can exceed to reserve the last word
 *                                4. set it to negetive number to remove the last word if cut in the middle.
 * @param  {Boolean}        [options.keepWhitespaces] keep whitespaces, by default continuous
 *                                spaces will be replaced with one space
 *                                set it true to reserve them, and continuous spaces will count as one
 * @return {String}
 */</span>
truncate(html, [length], [options])
<span class="hljs-comment">// and truncate.setup to change default options</span>
truncate.setup(options)
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="default-options"></a><a href="#default-options" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Default options</h3>
<pre><code class="hljs css language-js">{
  <span class="hljs-attr">byWords</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">stripTags</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">ellipsis</span>: <span class="hljs-string">'...'</span>,
  <span class="hljs-attr">decodeEntities</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">keepWhitespaces</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">excludes</span>: <span class="hljs-string">''</span>,
  <span class="hljs-attr">reserveLastWord</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">keepWhitespaces</span>: <span class="hljs-literal">false</span>
}
</code></pre>
<p>You can change default options by using <code>truncate.setup</code></p>
<p>e.g.</p>
<pre><code class="hljs css language-js">truncate.setup({ <span class="hljs-attr">stripTags</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">length</span>: <span class="hljs-number">10</span> })
truncate(<span class="hljs-string">'&lt;p&gt;&lt;img src="xxx.jpg"&gt;Hello from earth!&lt;/p&gt;'</span>)
<span class="hljs-comment">// =&gt; Hello from</span>
</code></pre>
<p>or use existing <a href="https://github.com/cheeriojs/cheerio#loading">cheerio instance</a></p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> cheerio <span class="hljs-keyword">from</span> <span class="hljs-string">'cheerio'</span>
truncate.setup({ <span class="hljs-attr">stripTags</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">length</span>: <span class="hljs-number">10</span> })
<span class="hljs-comment">// truncate option `decodeEntities` will not work</span>
<span class="hljs-comment">//    you should config it in cheerio options by yourself</span>
<span class="hljs-keyword">const</span> $ = cheerio.load(<span class="hljs-string">'&lt;p&gt;&lt;img src="xxx.jpg"&gt;Hello from earth!&lt;/p&gt;'</span>, {
  <span class="hljs-comment">/** set decodeEntities if you need it */</span>
  decodeEntities: <span class="hljs-literal">true</span>
  <span class="hljs-comment">/* any cheerio instance options*/</span>
})
truncate($)
<span class="hljs-comment">// =&gt; Hello from</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="notice"></a><a href="#notice" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Notice</h2>
<h3><a class="anchor" aria-hidden="true" id="typescript-support"></a><a href="#typescript-support" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Typescript support</h3>
<p>This lib is written with typescript and has a defination file along with it. You may need to update your <code>tsconfig.json</code> by adding <code>&quot;esModuleInterop&quot;: true</code> to the <code>compilerOptions</code> if you encounter some typing errors, see #19.</p>
<h3><a class="anchor" aria-hidden="true" id="about-final-string-length"></a><a href="#about-final-string-length" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>About final string length</h3>
<p>If the html string content's length is shorter than <code>options.length</code>, then no ellipsis will be appended to the final html string. If longer, then the final string length will be <code>options.length</code> + <code>options.ellipsis</code>. And if you set <code>reserveLastWord</code> to true of none zero number, the final string will be various.</p>
<h3><a class="anchor" aria-hidden="true" id="about-html-comments"></a><a href="#about-html-comments" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>About html comments</h3>
<p>All html comments <code>&lt;!-- xxx --&gt;</code> will be removed</p>
<h3><a class="anchor" aria-hidden="true" id="about-dealing-with-none-alphabetic-languages"></a><a href="#about-dealing-with-none-alphabetic-languages" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>About dealing with none alphabetic languages</h3>
<p>When dealing with none alphabetic languages, such as Chinese/Japanese/Korean, they don't separate words with whitespaces, so options <code>byWords</code> and <code>reserveLastWord</code> should only works well with alphabetic languages.</p>
<p>And the only dependency of this project <code>cheerio</code> has an issue when dealing with none alphabetic languages, see <a href="#known-issues">Known Issues</a> for details.</p>
<h3><a class="anchor" aria-hidden="true" id="using-existing-cheerio-instance"></a><a href="#using-existing-cheerio-instance" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using existing cheerio instance</h3>
<p>If you want to use existing cheerio instance, truncate option <code>decodeEntities</code> will not work, you should set it in your own cheerio instance:</p>
<pre><code class="hljs css language-js"><span class="hljs-keyword">const</span> $ = cheerio.load(<span class="hljs-string">`<span class="hljs-subst">${html}</span>`</span>, {
  <span class="hljs-attr">decodeEntities</span>: <span class="hljs-literal">true</span>
  <span class="hljs-comment">/** other cheerio options */</span>
})
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="examples"></a><a href="#examples" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Examples</h2>
<pre><code class="hljs css language-javascript"><span class="hljs-keyword">var</span> truncate = <span class="hljs-built_in">require</span>(<span class="hljs-string">'truncate-html'</span>)

<span class="hljs-comment">// truncate html</span>
<span class="hljs-keyword">var</span> html = <span class="hljs-string">'&lt;p&gt;&lt;img src="abc.png"&gt;This is a string&lt;/p&gt; for test.'</span>
truncate(html, <span class="hljs-number">10</span>)
<span class="hljs-comment">// returns: &lt;p&gt;&lt;img src="abc.png"&gt;This is a ...&lt;/p&gt;</span>

<span class="hljs-comment">// truncate string with emojis</span>
<span class="hljs-keyword">var</span> string = <span class="hljs-string">'&lt;p&gt;poo 💩💩💩💩💩&lt;p&gt;'</span>
truncate(string, <span class="hljs-number">6</span>)
<span class="hljs-comment">// returns: &lt;p&gt;poo 💩💩...&lt;/p&gt;</span>

<span class="hljs-comment">// with options, remove all tags</span>
<span class="hljs-keyword">var</span> html = <span class="hljs-string">'&lt;p&gt;&lt;img src="abc.png"&gt;This is a string&lt;/p&gt; for test.'</span>
truncate(html, <span class="hljs-number">10</span>, { <span class="hljs-attr">stripTags</span>: <span class="hljs-literal">true</span> })
<span class="hljs-comment">// returns: This is a ...</span>

<span class="hljs-comment">// with options, truncate by words.</span>
<span class="hljs-comment">//  if you try to truncate none alphabet language(like CJK)</span>
<span class="hljs-comment">//      it will not act as you wish</span>
<span class="hljs-keyword">var</span> html = <span class="hljs-string">'&lt;p&gt;&lt;img src="abc.png"&gt;This is a string&lt;/p&gt; for test.'</span>
truncate(html, <span class="hljs-number">3</span>, { <span class="hljs-attr">byWords</span>: <span class="hljs-literal">true</span> })
<span class="hljs-comment">// returns: &lt;p&gt;&lt;img src="abc.png"&gt;This is a ...&lt;/p&gt;</span>

<span class="hljs-comment">// with options, keep whitespaces</span>
<span class="hljs-keyword">var</span> html = <span class="hljs-string">'&lt;p&gt;         &lt;img src="abc.png"&gt;This is a string&lt;/p&gt; for test.'</span>
truncate(html, <span class="hljs-number">10</span>, { <span class="hljs-attr">keepWhitespaces</span>: <span class="hljs-literal">true</span> })
<span class="hljs-comment">// returns: &lt;p&gt;         &lt;img src="abc.png"&gt;This is a ...&lt;/p&gt;</span>

<span class="hljs-comment">// combine length and options</span>
<span class="hljs-keyword">var</span> html = <span class="hljs-string">'&lt;p&gt;&lt;img src="abc.png"&gt;This is a string&lt;/p&gt; for test.'</span>
truncate(html, {
  <span class="hljs-attr">length</span>: <span class="hljs-number">10</span>,
  <span class="hljs-attr">stripTags</span>: <span class="hljs-literal">true</span>
})
<span class="hljs-comment">// returns: This is a ...</span>

<span class="hljs-comment">// custom ellipsis sign</span>
<span class="hljs-keyword">var</span> html = <span class="hljs-string">'&lt;p&gt;&lt;img src="abc.png"&gt;This is a string&lt;/p&gt; for test.'</span>
truncate(html, {
  <span class="hljs-attr">length</span>: <span class="hljs-number">10</span>,
  <span class="hljs-attr">ellipsis</span>: <span class="hljs-string">'~'</span>
})
<span class="hljs-comment">// reutrns: &lt;p&gt;&lt;img src="abc.png"&gt;This is a ~&lt;/p&gt;</span>

<span class="hljs-comment">// exclude some special elements(by selector), they will be removed before counting content's length</span>
<span class="hljs-keyword">var</span> html = <span class="hljs-string">'&lt;p&gt;&lt;img src="abc.png"&gt;This is a string&lt;/p&gt; for test.'</span>
truncate(html, {
  <span class="hljs-attr">length</span>: <span class="hljs-number">10</span>,
  <span class="hljs-attr">ellipsis</span>: <span class="hljs-string">'~'</span>,
  <span class="hljs-attr">excludes</span>: <span class="hljs-string">'img'</span>
})
<span class="hljs-comment">// reutrns: &lt;p&gt;This is a ~&lt;/p&gt;</span>

<span class="hljs-comment">// exclude more than one category elements</span>
<span class="hljs-keyword">var</span> html =
  <span class="hljs-string">'&lt;p&gt;&lt;img src="abc.png"&gt;This is a string&lt;/p&gt;&lt;div class="something-unwanted"&gt; unwanted string inserted ( ´•̥̥̥ω•̥̥̥` ）&lt;/div&gt; for test.'</span>
truncate(html, {
  <span class="hljs-attr">length</span>: <span class="hljs-number">20</span>,
  <span class="hljs-attr">stripTags</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">ellipsis</span>: <span class="hljs-string">'~'</span>,
  <span class="hljs-attr">excludes</span>: [<span class="hljs-string">'img'</span>, <span class="hljs-string">'.something-unwanted'</span>]
})
<span class="hljs-comment">// returns: This is a string for~</span>

<span class="hljs-comment">// handing encoded characters</span>
<span class="hljs-keyword">var</span> html = <span class="hljs-string">'&lt;p&gt;&amp;nbsp;test for &amp;lt;p&amp;gt; encoded string&lt;/p&gt;'</span>
truncate(html, {
  <span class="hljs-attr">length</span>: <span class="hljs-number">20</span>,
  <span class="hljs-attr">decodeEntities</span>: <span class="hljs-literal">true</span>
})
<span class="hljs-comment">// returns: &lt;p&gt; test for &amp;lt;p&amp;gt; encode...&lt;/p&gt;</span>

<span class="hljs-comment">// when set decodeEntities false</span>
<span class="hljs-keyword">var</span> html = <span class="hljs-string">'&lt;p&gt;&amp;nbsp;test for &amp;lt;p&amp;gt; encoded string&lt;/p&gt;'</span>
truncate(html, {
  <span class="hljs-attr">length</span>: <span class="hljs-number">20</span>,
  <span class="hljs-attr">decodeEntities</span>: <span class="hljs-literal">false</span> <span class="hljs-comment">// this is the dafault value</span>
})
<span class="hljs-comment">// returns: &lt;p&gt;&amp;nbsp;test for &amp;lt;p...&lt;/p&gt;</span>

<span class="hljs-comment">// and there may be a surprise by setting `decodeEntities` to true  when handing CJK characters</span>
<span class="hljs-keyword">var</span> html = <span class="hljs-string">'&lt;p&gt;&amp;nbsp;test for &amp;lt;p&amp;gt; 中文 string&lt;/p&gt;'</span>
truncate(html, {
  <span class="hljs-attr">length</span>: <span class="hljs-number">20</span>,
  <span class="hljs-attr">decodeEntities</span>: <span class="hljs-literal">true</span>
})
<span class="hljs-comment">// returns: &lt;p&gt; test for &amp;lt;p&amp;gt; &amp;#x4E2D;&amp;#x6587; str...&lt;/p&gt;</span>
<span class="hljs-comment">// to fix this, see below for instructions</span>
</code></pre>
<p>for More usages, check <a href="./test/truncate.spec.ts">truncate.spec.ts</a></p>
<h2><a class="anchor" aria-hidden="true" id="known-issues"></a><a href="#known-issues" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Known issues</h2>
<p>Known issues about handing CJK(Chinese/Japanese/Korean) characters when set the option <code>decodeEntities</code> to <code>true</code>.</p>
<p>You have seen the option <code>decodeEntities</code>, it's really magic! When it's true, encoded html entities will be decoded automatically, so <code>&amp;amp;</code> will be treat as a single character. This is probably what we want. But, if there are CJK characters in the html string, they will be replaced by characters like <code>&amp;#xF6;</code>(still count as one character when truncating) in the final html you get. That's confused.</p>
<p>To fix this, you have two choices:</p>
<ul>
<li>keep the option <code>decodeEntities</code> false, but <code>&amp;amp;</code> will treat as five characters.</li>
<li>modify cheerio's source code: find out the function <code>getInverse</code> in the file <code>./node_modules/cheerio/node_modules/entities/lib/decode.js</code>, comment out the last line <code>.replace(re_nonASCII, singleCharReplacer);</code>.</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="credits"></a><a href="#credits" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Credits</h2>
<p>Thanks to:</p>
<ul>
<li><a href="https://github.com/calebeno">@calebeno</a> es6 support and unit tests</li>
<li><a href="https://github.com/aaditya-thakkar">@aaditya-thakkar</a> emoji truncating support</li>
</ul>
</span></div></article></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#installation">Installation</a></li><li><a href="#try-it-online">Try it online</a></li><li><a href="#api">API</a><ul class="toc-headings"><li><a href="#default-options">Default options</a></li></ul></li><li><a href="#notice">Notice</a><ul class="toc-headings"><li><a href="#typescript-support">Typescript support</a></li><li><a href="#about-final-string-length">About final string length</a></li><li><a href="#about-html-comments">About html comments</a></li><li><a href="#about-dealing-with-none-alphabetic-languages">About dealing with none alphabetic languages</a></li><li><a href="#using-existing-cheerio-instance">Using existing cheerio instance</a></li></ul></li><li><a href="#examples">Examples</a></li><li><a href="#known-issues">Known issues</a></li><li><a href="#credits">Credits</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/underbase/" class="nav-home"><img src="/underbase/img/logo.svg" alt="Underbase" width="66" height="58"/></a><div><h5>Docs</h5><a href="/underbase/docs/en/doc1.html">Getting Started (or other categories)</a><a href="/underbase/docs/en/doc2.html">Guides (or other categories)</a><a href="/underbase/docs/en/doc3.html">API Reference (or other categories)</a></div><div><h5>Community</h5><a href="https://stackoverflow.com/questions/tagged/" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://discordapp.com/">Project Chat</a><a href="https://twitter.com/" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/underbase/blog">Blog</a><a href="https://github.com/">GitHub</a><a class="github-button" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section></footer></div></body></html>